<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="NoticeMapper">
  <resultMap type="Notice" id="noticeResultMap">
    <id     property="noticeNo"      column="NOTICE_NO"/>
    <result property="noticeSubject" column="NOTICE_SUBJECT"/>
    <result property="noticeContent" column="NOTICE_CONTENT"/>
    <result property="noticeWriter"  column="NOTICE_WRITER"/>
    <result property="noticeDate"    column="NOTICE_DATE"/>
    <result property="updateDate"    column="UPDATE_DATE"/>
    <result property="viewCount"     column="VIEW_COUNT"/>
  </resultMap>
  
  <select id="selectList" resultMap="noticeResultMap">
    SELECT * FROM NOTICE_TBL ORDER BY NOTICE_NO DESC
  </select>
  
  <select id="selectOneByNo" resultMap="noticeResultMap">
    SELECT * FROM NOTICE_TBL WHERE NOTICE_NO = #{noticeNo} 
  </select>
  
  <insert id="insertNotice">
    INSERT INTO NOTICE_TBL
    VALUES(SEQ_NOTICE_NO.NEXTVAL, #{noticeSubject}, #{noticeContent}, #{noticeWriter}, DEFAULT, DEFAULT, DEFAULT)
  </insert>
  
    <update id = "updateNotice">
  	UPDATE NOTICE_TBL
  	SET NOTICE_SUBJECT = #{noticeSubject}, NOTICE_CONTENT = #{noticeContent}
  	, UPDATE_DATE = DEFAULT
  	WHERE NOTICE_NO = #{noticeNo }
  </update>
  
  <delete id="deleteNotice">
    DELETE FROM NOTICE_TBL WHERE NOTICE_NO = #{noticeNo}
  </delete>
  
  <select id="getTotalCount" resultType="_int">
  	SELECT COUNT(*) FROM NOTICE_TBL
  </select>
<!-- parameterType="map" 또는 parameterType="hashMap" 생략 -->
	<select id="selectSearchList" resultMap="noticeResultMap">
	<where>
<!-- 전체에서 검색하는 쿼리문 -->	
	<if test="serchCondition == 'all'">
		SELECT * FROM NOTICE_TBL 
		WHERE NOTICE_SUBJECT LIKE '%'||#{searchKeyword}||'%'
		OR NOTICE_SUBJECT LIKE '%'||#{searchKeyword}||'%' OR NOTICE_CONTENT LIKE '%'||#{searchKeyword}||'%'
	</if>
<!-- 작성자로 검색하는 쿼리문 -->
	<if test="searchCondition == 'writer'">
	SELECT * FROM NOTICE NOTICE_TBL WHERE NOTICE_WRITER LIKE '%'||#{searchKeyword}||'%'
	</if>
<!-- 제목으로 검하는 쿼리문 -->
	<if test="searchCondition == 'subject'">
	SELECT * FROM NOTICE_TBL WHERE NOTICE_SUBJECT LIKE '%'||#{searchKeyword}||'%'
	</if>
<!-- 내용으로 검색하는 쿼리문 -->
	<if test="searchCondition == 'content'">
	SELECT * FROM NOTICE_TBL WHERE NOTICE_CONTENT LIKE '%'|||#{searchKeyword}||'%'
	</if>
	</where>
	ORDER BY NOTICE_NO DESC
	</select>
</mapper>